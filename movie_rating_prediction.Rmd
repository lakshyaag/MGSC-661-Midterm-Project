---
title: "MGSC 661 - Midterm Project"
output: html_notebook
---


# Importing data
```{r}
require(visreg)
require(glue)
require(car)
require(lmtest)
require(splines)
require(psych)
require(stargazer)
require(plm)
require(ggplot2)
require(ggtext)
require(ggpubr)
require(scales)
require(caTools)
require(methods)
require(boot)

windowsFonts(Helvetica = "Product Sans")
```

```{r}
theme_lox <- function() {
    theme(
        panel.grid.major.x = element_line(linewidth = 0.3, colour = "#cbcbcb"),
        panel.grid.major.y = element_line(linewidth = 0.3, colour = "#cbcbcb"),
        plot.title = element_markdown(
            family = "Helvetica",
            size = 22,
            face = "bold",
            color = "#222222"
        ),
        plot.subtitle = element_text(
            family = "Helvetica",
            size = 16,
            margin = margin(2, 0, 2, 0)
        ),
        plot.caption = element_text(family = "Helvetica", face = "bold"),
        axis.text = element_text(
            family = "Helvetica",
            size = 12,
            color = "#222222"
        ),
        axis.title = element_text(
            family = "Helvetica",
            size = 14,
            color = "#222222"
        ),
        legend.text = element_text(family = "Helvetica", size = 12),
        legend.title = element_text(
            family = "Helvetica",
            size = 14,
            face = "bold"
        ),
        legend.position = "right",
        strip.text = element_text(
            family = "Helvetica",
            size = 12,
            hjust = 0.5
        )
    )
}
```

```{r}
data <- read.csv('./IMDB_data_Fall_2023.csv')
attach(data)
```

# Exploratory data analysis

```{r}
head(data)
summary(data)
```


## Data cleaning

```{r}
# Check for duplicates
data[duplicated(data)]
```
## Univariate distributions

### Target variable
```{r}
ggplot(data, aes(x = imdb_score)) + 
  geom_histogram(binwidth = 1) +
  scale_x_continuous(breaks = breaks_width(width = 1)) +
  labs(x = "IMDb Rating", y = "Number of movies", title = "Distribution of ratings") +
  theme_pubr() +
  theme_lox()
```
### Movie budget

```{r}
ggplot(data, aes(x = movie_budget)) + 
  geom_histogram(bins = 20) +
  scale_x_continuous(breaks = breaks_pretty(), labels = label_dollar(scale_cut = cut_short_scale())) +
  labs(x = "Movie budget", y = "Number of movies", title = "Distribution of movie budgets") +
  theme_pubr() +
  theme_lox()
```

### Release year
```{r}
ggplot(data, aes(x = release_year)) +
  geom_histogram(bins = 10) +
  scale_x_continuous(breaks = breaks_pretty(n = 10)) +
  labs(x = "Release Year", y = "Number of movies", title = "Distribution of release year") +
  theme_pubr() +
  theme_lox()
```
### Number of faces
```{r}
ggplot(data, aes(x = nb_faces)) + 
  geom_histogram() +
  scale_x_continuous(breaks = breaks_pretty()) +
  labs(x = "Number of faces", y = "Number of movies", title = "Distribution of number of faces in the movie poster") +
  theme_pubr() +
  theme_lox()
```

## Bivariate distributions

### Movie budgets ~ IMDb Score
```{r}
ggplot(data, aes(x = movie_budget, y = imdb_score)) +
  geom_point() +
  scale_x_continuous(breaks = breaks_pretty(), labels = label_dollar(scale_cut = cut_short_scale())) +
  labs(x = "Movie budget", y = "IMDb Score", title = "Movie budget and IMDb score") +
  theme_pubr() +
  theme_lox()
```